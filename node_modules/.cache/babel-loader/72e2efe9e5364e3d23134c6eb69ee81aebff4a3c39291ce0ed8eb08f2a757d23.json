{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\eniac\\\\Desktop\\\\deepblue\\\\src\\\\components\\\\Whiteboard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Stage, Layer, Line, Rect, Circle, Image, Transformer } from 'react-konva';\nimport io from 'socket.io-client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst socket = io('http://192.168.31.158:3001', {\n  transports: ['websocket', 'polling'],\n  reconnectionDelay: 1000,\n  reconnectionAttempts: 10,\n  forceNew: true\n});\nconst Whiteboard = () => {\n  _s();\n  const [lines, setLines] = useState([]);\n  const [shapes, setShapes] = useState([]);\n  const [selectedId, setSelectedId] = useState(null);\n  const [tool, setTool] = useState('pen'); // pen, eraser, line, rectangle, circle, select\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [startPos, setStartPos] = useState({\n    x: 0,\n    y: 0\n  });\n  const transformerRef = useRef();\n  const stageRef = useRef();\n  useEffect(() => {\n    socket.on('draw-update', ({\n      lines,\n      shapes\n    }) => {\n      setLines(lines);\n      setShapes(shapes);\n    });\n    return () => {\n      socket.off('draw-update');\n    };\n  }, []);\n  useEffect(() => {\n    if (selectedId) {\n      const shape = shapes.find(s => s.id === selectedId);\n      if (shape && transformerRef.current) {\n        transformerRef.current.nodes([stageRef.current.findOne('#' + selectedId)]);\n        transformerRef.current.getLayer().batchDraw();\n      }\n    }\n  }, [selectedId, shapes]);\n\n  // Update the handleMouseDown function\n  const handleMouseDown = e => {\n    const pos = e.target.getStage().getPointerPosition();\n    setIsDrawing(true);\n    setStartPos(pos);\n    if (tool === 'pen') {\n      const newLines = [...lines, {\n        tool,\n        points: [pos.x, pos.y]\n      }];\n      setLines(newLines);\n      socket.emit('draw-update', {\n        lines: newLines,\n        shapes\n      });\n    } else if (tool === 'eraser') {\n      const newLines = [...lines, {\n        tool,\n        points: [pos.x, pos.y]\n      }];\n      setLines(newLines);\n      socket.emit('draw-update', {\n        lines: newLines,\n        shapes\n      });\n    } else if (tool === 'select') {\n      const clickedShape = e.target;\n      if (clickedShape === e.target.getStage()) {\n        setSelectedId(null);\n        return;\n      }\n      // Prevent deselection when clicking transform handles\n      if (clickedShape.getParent().className === 'Transformer') {\n        return;\n      }\n      setSelectedId(clickedShape.id());\n    }\n  };\n\n  // Update the Transformer component\n  {\n    selectedId && tool === 'select' && /*#__PURE__*/_jsxDEV(Transformer, {\n      ref: transformerRef,\n      boundBoxFunc: (oldBox, newBox) => {\n        const isValid = newBox.width > 5 && newBox.height > 5;\n        return isValid ? newBox : oldBox;\n      },\n      rotationSnaps: [0, 45, 90, 135, 180, 225, 270, 315],\n      enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right'],\n      keepRatio: false,\n      ignoreStroke: true,\n      padding: 5,\n      anchorSize: 10,\n      anchorCornerRadius: 5,\n      borderStroke: \"#00ff00\",\n      anchorStroke: \"#00ff00\",\n      anchorFill: \"#ffffff\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 5\n    }, this);\n  }\n  const handleMouseMove = e => {\n    if (!isDrawing) return;\n    const stage = e.target.getStage();\n    const point = stage.getPointerPosition();\n    if (tool === 'pen' || tool === 'eraser') {\n      const lastLine = lines[lines.length - 1];\n      lastLine.points = lastLine.points.concat([point.x, point.y]);\n      const newLines = [...lines.slice(0, -1), lastLine];\n      setLines(newLines);\n      socket.emit('draw-update', {\n        lines: newLines,\n        shapes\n      });\n    } else if (['line', 'rectangle', 'circle'].includes(tool)) {\n      const newShapes = [...shapes];\n      const index = newShapes.findIndex(s => s.id === 'temp');\n      const shapeData = {\n        id: 'temp',\n        type: tool,\n        x: startPos.x,\n        y: startPos.y,\n        width: point.x - startPos.x,\n        height: point.y - startPos.y\n      };\n      if (index === -1) {\n        newShapes.push(shapeData);\n      } else {\n        newShapes[index] = shapeData;\n      }\n      setShapes(newShapes);\n      socket.emit('draw-update', {\n        lines,\n        shapes: newShapes\n      });\n    }\n  };\n  const handleMouseUp = () => {\n    setIsDrawing(false);\n    if (['line', 'rectangle', 'circle'].includes(tool)) {\n      const newShapes = shapes.map(shape => shape.id === 'temp' ? {\n        ...shape,\n        id: Date.now().toString()\n      } : shape);\n      setShapes(newShapes);\n      socket.emit('draw-update', {\n        lines,\n        shapes: newShapes\n      });\n    }\n  };\n  const handleImageUpload = e => {\n    const file = e.target.files[0];\n    if (!file) return;\n\n    // Add file size check\n    if (file.size > 5000000) {\n      // 5MB limit\n      alert('Image size should be less than 5MB');\n      return;\n    }\n    const reader = new FileReader();\n    reader.onload = () => {\n      const img = new window.Image();\n      img.crossOrigin = 'Anonymous';\n      img.src = reader.result;\n      img.onload = () => {\n        // Resize image if too large\n        const canvas = document.createElement('canvas');\n        const ctx = canvas.getContext('2d');\n        const aspectRatio = img.height / img.width;\n        const newWidth = Math.min(300, img.width);\n        const newHeight = newWidth * aspectRatio;\n        canvas.width = newWidth;\n        canvas.height = newHeight;\n        ctx.drawImage(img, 0, 0, newWidth, newHeight);\n        const resizedImage = canvas.toDataURL('image/jpeg', 0.7);\n        const newShape = {\n          id: Date.now().toString(),\n          type: 'image',\n          x: 50,\n          y: 50,\n          width: newWidth,\n          height: newHeight,\n          image: resizedImage,\n          rotation: 0\n        };\n        const newShapes = [...shapes, newShape];\n        setShapes(newShapes);\n        socket.emit('draw-update', {\n          lines,\n          shapes: newShapes\n        });\n      };\n    };\n    reader.readAsDataURL(file);\n  };\n  const handleDragEnd = e => {\n    const shape = e.target;\n    const newShapes = shapes.map(s => {\n      if (s.id === shape.id()) {\n        if (s.type === 'circle') {\n          return {\n            ...s,\n            x: shape.x() - s.width / 2,\n            y: shape.y() - s.height / 2\n          };\n        }\n        return {\n          ...s,\n          x: shape.x(),\n          y: shape.y()\n        };\n      }\n      return s;\n    });\n    setShapes(newShapes);\n    socket.emit('draw-update', {\n      lines,\n      shapes: newShapes\n    });\n  };\n  const handleTransformEnd = e => {\n    const node = e.target;\n    const scaleX = node.scaleX();\n    const scaleY = node.scaleY();\n    node.scaleX(1);\n    node.scaleY(1);\n    const newShapes = shapes.map(shape => shape.id === node.id() ? {\n      ...shape,\n      x: node.x(),\n      y: node.y(),\n      width: Math.abs(node.width() * scaleX),\n      height: Math.abs(node.height() * scaleY),\n      rotation: node.rotation()\n    } : shape);\n    setShapes(newShapes);\n    socket.emit('draw-update', {\n      lines,\n      shapes: newShapes\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 10,\n        left: 10,\n        zIndex: 1\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('pen'),\n        children: \"Pen\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('eraser'),\n        children: \"Eraser\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('line'),\n        children: \"Line\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('rectangle'),\n        children: \"Rectangle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('circle'),\n        children: \"Circle\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setTool('select'),\n        children: \"Select\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        accept: \"image/*\",\n        onChange: handleImageUpload\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setLines([]);\n          setShapes([]);\n          socket.emit('draw-update', {\n            lines: [],\n            shapes: []\n          });\n        },\n        children: \"Clear All\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Stage, {\n      ref: stageRef,\n      width: window.innerWidth,\n      height: window.innerHeight,\n      onMouseDown: handleMouseDown,\n      onMouseMove: handleMouseMove,\n      onMouseUp: handleMouseUp,\n      onTouchStart: handleMouseDown,\n      onTouchMove: handleMouseMove,\n      onTouchEnd: handleMouseUp,\n      children: /*#__PURE__*/_jsxDEV(Layer, {\n        children: [lines.map((line, i) => /*#__PURE__*/_jsxDEV(Line, {\n          points: line.points,\n          stroke: line.tool === 'eraser' ? '#ffffff' : '#000000',\n          strokeWidth: line.tool === 'eraser' ? 20 : 5,\n          tension: 0.5,\n          lineCap: \"round\",\n          lineJoin: \"round\",\n          globalCompositeOperation: line.tool === 'eraser' ? 'destination-out' : 'source-over'\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 13\n        }, this)), shapes.map(shape => {\n          if (shape.type === 'line') {\n            return /*#__PURE__*/_jsxDEV(Line, {\n              id: shape.id,\n              points: [shape.x, shape.y, shape.x + shape.width, shape.y + shape.height],\n              stroke: \"#000000\",\n              strokeWidth: 5,\n              draggable: tool === 'select',\n              onClick: () => setSelectedId(shape.id),\n              onTransformEnd: handleTransformEnd\n            }, shape.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 17\n            }, this);\n          } else if (shape.type === 'rectangle') {\n            return /*#__PURE__*/_jsxDEV(Rect, {\n              id: shape.id,\n              x: shape.x,\n              y: shape.y,\n              width: shape.width,\n              height: shape.height,\n              rotation: shape.rotation,\n              stroke: \"#000000\",\n              strokeWidth: 5,\n              draggable: tool === 'select',\n              onClick: () => tool === 'select' && setSelectedId(shape.id),\n              onDragEnd: handleDragEnd,\n              onTransformEnd: handleTransformEnd\n            }, shape.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 17\n            }, this);\n          } else if (shape.type === 'circle') {\n            return /*#__PURE__*/_jsxDEV(Circle, {\n              id: shape.id,\n              x: shape.x + shape.width / 2,\n              y: shape.y + shape.height / 2,\n              radius: Math.abs(shape.width) / 2,\n              stroke: \"#000000\",\n              strokeWidth: 5,\n              draggable: tool === 'select',\n              onClick: () => tool === 'select' && setSelectedId(shape.id),\n              onDragEnd: handleDragEnd,\n              onTransformEnd: handleTransformEnd,\n              rotation: shape.rotation\n            }, shape.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 17\n            }, this);\n          } else if (shape.type === 'image') {\n            const imageObj = new window.Image();\n            imageObj.src = shape.image;\n            return /*#__PURE__*/_jsxDEV(Image, {\n              id: shape.id,\n              image: imageObj,\n              x: shape.x,\n              y: shape.y,\n              width: shape.width,\n              height: shape.height,\n              rotation: shape.rotation,\n              draggable: tool === 'select',\n              onClick: () => tool === 'select' && setSelectedId(shape.id),\n              onDragEnd: handleDragEnd,\n              onTransformEnd: handleTransformEnd\n            }, shape.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 324,\n              columnNumber: 17\n            }, this);\n          }\n          return null;\n        }), selectedId && tool === 'select' && /*#__PURE__*/_jsxDEV(Transformer, {\n          ref: transformerRef,\n          boundBoxFunc: (oldBox, newBox) => {\n            const isValid = newBox.width > 5 && newBox.height > 5;\n            return isValid ? newBox : oldBox;\n          },\n          rotationSnaps: [0, 45, 90, 135, 180, 225, 270, 315],\n          enabledAnchors: ['top-left', 'top-right', 'bottom-left', 'bottom-right']\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 230,\n    columnNumber: 5\n  }, this);\n};\n_s(Whiteboard, \"eh9DEfyUTkjNyeLSNNEu6KlgQrk=\");\n_c = Whiteboard;\nexport default Whiteboard;\nvar _c;\n$RefreshReg$(_c, \"Whiteboard\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Stage","Layer","Line","Rect","Circle","Image","Transformer","io","jsxDEV","_jsxDEV","socket","transports","reconnectionDelay","reconnectionAttempts","forceNew","Whiteboard","_s","lines","setLines","shapes","setShapes","selectedId","setSelectedId","tool","setTool","isDrawing","setIsDrawing","startPos","setStartPos","x","y","transformerRef","stageRef","on","off","shape","find","s","id","current","nodes","findOne","getLayer","batchDraw","handleMouseDown","e","pos","target","getStage","getPointerPosition","newLines","points","emit","clickedShape","getParent","className","ref","boundBoxFunc","oldBox","newBox","isValid","width","height","rotationSnaps","enabledAnchors","keepRatio","ignoreStroke","padding","anchorSize","anchorCornerRadius","borderStroke","anchorStroke","anchorFill","fileName","_jsxFileName","lineNumber","columnNumber","handleMouseMove","stage","point","lastLine","length","concat","slice","includes","newShapes","index","findIndex","shapeData","type","push","handleMouseUp","map","Date","now","toString","handleImageUpload","file","files","size","alert","reader","FileReader","onload","img","window","crossOrigin","src","result","canvas","document","createElement","ctx","getContext","aspectRatio","newWidth","Math","min","newHeight","drawImage","resizedImage","toDataURL","newShape","image","rotation","readAsDataURL","handleDragEnd","handleTransformEnd","node","scaleX","scaleY","abs","children","style","position","top","left","zIndex","onClick","accept","onChange","innerWidth","innerHeight","onMouseDown","onMouseMove","onMouseUp","onTouchStart","onTouchMove","onTouchEnd","line","i","stroke","strokeWidth","tension","lineCap","lineJoin","globalCompositeOperation","draggable","onTransformEnd","onDragEnd","radius","imageObj","_c","$RefreshReg$"],"sources":["C:/Users/eniac/Desktop/deepblue/src/components/Whiteboard.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Stage, Layer, Line, Rect, Circle, Image, Transformer } from 'react-konva';\r\nimport io from 'socket.io-client';\r\n\r\nconst socket = io('http://192.168.31.158:3001', {\r\n  transports: ['websocket', 'polling'],\r\n  reconnectionDelay: 1000,\r\n  reconnectionAttempts: 10,\r\n  forceNew: true\r\n});\r\n\r\nconst Whiteboard = () => {\r\n  const [lines, setLines] = useState([]);\r\n  const [shapes, setShapes] = useState([]);\r\n  const [selectedId, setSelectedId] = useState(null);\r\n  const [tool, setTool] = useState('pen'); // pen, eraser, line, rectangle, circle, select\r\n  const [isDrawing, setIsDrawing] = useState(false);\r\n  const [startPos, setStartPos] = useState({ x: 0, y: 0 });\r\n  const transformerRef = useRef();\r\n  const stageRef = useRef();\r\n\r\n  useEffect(() => {\r\n    socket.on('draw-update', ({ lines, shapes }) => {\r\n      setLines(lines);\r\n      setShapes(shapes);\r\n    });\r\n\r\n    return () => {\r\n      socket.off('draw-update');\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (selectedId) {\r\n      const shape = shapes.find(s => s.id === selectedId);\r\n      if (shape && transformerRef.current) {\r\n        transformerRef.current.nodes([stageRef.current.findOne('#' + selectedId)]);\r\n        transformerRef.current.getLayer().batchDraw();\r\n      }\r\n    }\r\n  }, [selectedId, shapes]);\r\n\r\n  // Update the handleMouseDown function\r\n  const handleMouseDown = (e) => {\r\n    const pos = e.target.getStage().getPointerPosition();\r\n    setIsDrawing(true);\r\n    setStartPos(pos);\r\n  \r\n    if (tool === 'pen') {\r\n      const newLines = [...lines, { tool, points: [pos.x, pos.y] }];\r\n      setLines(newLines);\r\n      socket.emit('draw-update', { lines: newLines, shapes });\r\n    } else if (tool === 'eraser') {\r\n      const newLines = [...lines, { tool, points: [pos.x, pos.y] }];\r\n      setLines(newLines);\r\n      socket.emit('draw-update', { lines: newLines, shapes });\r\n    } else if (tool === 'select') {\r\n      const clickedShape = e.target;\r\n      if (clickedShape === e.target.getStage()) {\r\n        setSelectedId(null);\r\n        return;\r\n      }\r\n      // Prevent deselection when clicking transform handles\r\n      if (clickedShape.getParent().className === 'Transformer') {\r\n        return;\r\n      }\r\n      setSelectedId(clickedShape.id());\r\n    }\r\n  };\r\n  \r\n  // Update the Transformer component\r\n  {selectedId && tool === 'select' && (\r\n    <Transformer\r\n      ref={transformerRef}\r\n      boundBoxFunc={(oldBox, newBox) => {\r\n        const isValid = newBox.width > 5 && newBox.height > 5;\r\n        return isValid ? newBox : oldBox;\r\n      }}\r\n      rotationSnaps={[0, 45, 90, 135, 180, 225, 270, 315]}\r\n      enabledAnchors={['top-left', 'top-right', 'bottom-left', 'bottom-right']}\r\n      keepRatio={false}\r\n      ignoreStroke={true}\r\n      padding={5}\r\n      anchorSize={10}\r\n      anchorCornerRadius={5}\r\n      borderStroke=\"#00ff00\"\r\n      anchorStroke=\"#00ff00\"\r\n      anchorFill=\"#ffffff\"\r\n    />\r\n  )}\r\n  const handleMouseMove = (e) => {\r\n    if (!isDrawing) return;\r\n\r\n    const stage = e.target.getStage();\r\n    const point = stage.getPointerPosition();\r\n\r\n    if (tool === 'pen' || tool === 'eraser') {\r\n      const lastLine = lines[lines.length - 1];\r\n      lastLine.points = lastLine.points.concat([point.x, point.y]);\r\n      const newLines = [...lines.slice(0, -1), lastLine];\r\n      setLines(newLines);\r\n      socket.emit('draw-update', { lines: newLines, shapes });\r\n    } else if (['line', 'rectangle', 'circle'].includes(tool)) {\r\n      const newShapes = [...shapes];\r\n      const index = newShapes.findIndex(s => s.id === 'temp');\r\n      const shapeData = {\r\n        id: 'temp',\r\n        type: tool,\r\n        x: startPos.x,\r\n        y: startPos.y,\r\n        width: point.x - startPos.x,\r\n        height: point.y - startPos.y,\r\n      };\r\n      \r\n      if (index === -1) {\r\n        newShapes.push(shapeData);\r\n      } else {\r\n        newShapes[index] = shapeData;\r\n      }\r\n      setShapes(newShapes);\r\n      socket.emit('draw-update', { lines, shapes: newShapes });\r\n    }\r\n  };\r\n\r\n  const handleMouseUp = () => {\r\n    setIsDrawing(false);\r\n    if (['line', 'rectangle', 'circle'].includes(tool)) {\r\n      const newShapes = shapes.map(shape => \r\n        shape.id === 'temp' ? { ...shape, id: Date.now().toString() } : shape\r\n      );\r\n      setShapes(newShapes);\r\n      socket.emit('draw-update', { lines, shapes: newShapes });\r\n    }\r\n  };\r\n\r\n  const handleImageUpload = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    // Add file size check\r\n    if (file.size > 5000000) { // 5MB limit\r\n      alert('Image size should be less than 5MB');\r\n      return;\r\n    }\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      const img = new window.Image();\r\n      img.crossOrigin = 'Anonymous';\r\n      img.src = reader.result;\r\n      img.onload = () => {\r\n        // Resize image if too large\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d');\r\n        const aspectRatio = img.height / img.width;\r\n        const newWidth = Math.min(300, img.width);\r\n        const newHeight = newWidth * aspectRatio;\r\n        \r\n        canvas.width = newWidth;\r\n        canvas.height = newHeight;\r\n        ctx.drawImage(img, 0, 0, newWidth, newHeight);\r\n        \r\n        const resizedImage = canvas.toDataURL('image/jpeg', 0.7);\r\n        \r\n        const newShape = {\r\n          id: Date.now().toString(),\r\n          type: 'image',\r\n          x: 50,\r\n          y: 50,\r\n          width: newWidth,\r\n          height: newHeight,\r\n          image: resizedImage,\r\n          rotation: 0,\r\n        };\r\n        \r\n        const newShapes = [...shapes, newShape];\r\n        setShapes(newShapes);\r\n        socket.emit('draw-update', { lines, shapes: newShapes });\r\n      };\r\n    };\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const handleDragEnd = (e) => {\r\n    const shape = e.target;\r\n    const newShapes = shapes.map(s => {\r\n      if (s.id === shape.id()) {\r\n        if (s.type === 'circle') {\r\n          return {\r\n            ...s,\r\n            x: shape.x() - s.width / 2,\r\n            y: shape.y() - s.height / 2\r\n          };\r\n        }\r\n        return {\r\n          ...s,\r\n          x: shape.x(),\r\n          y: shape.y()\r\n        };\r\n      }\r\n      return s;\r\n    });\r\n    setShapes(newShapes);\r\n    socket.emit('draw-update', { lines, shapes: newShapes });\r\n  };\r\n\r\n  const handleTransformEnd = (e) => {\r\n    const node = e.target;\r\n    const scaleX = node.scaleX();\r\n    const scaleY = node.scaleY();\r\n    \r\n    node.scaleX(1);\r\n    node.scaleY(1);\r\n    \r\n    const newShapes = shapes.map(shape => \r\n      shape.id === node.id() ? {\r\n        ...shape,\r\n        x: node.x(),\r\n        y: node.y(),\r\n        width: Math.abs(node.width() * scaleX),\r\n        height: Math.abs(node.height() * scaleY),\r\n        rotation: node.rotation()\r\n      } : shape\r\n    );\r\n    setShapes(newShapes);\r\n    socket.emit('draw-update', { lines, shapes: newShapes });\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <div style={{ position: 'fixed', top: 10, left: 10, zIndex: 1 }}>\r\n        <button onClick={() => setTool('pen')}>Pen</button>\r\n        <button onClick={() => setTool('eraser')}>Eraser</button>\r\n        <button onClick={() => setTool('line')}>Line</button>\r\n        <button onClick={() => setTool('rectangle')}>Rectangle</button>\r\n        <button onClick={() => setTool('circle')}>Circle</button>\r\n        <button onClick={() => setTool('select')}>Select</button>\r\n        <input type=\"file\" accept=\"image/*\" onChange={handleImageUpload} />\r\n        <button onClick={() => {\r\n          setLines([]);\r\n          setShapes([]);\r\n          socket.emit('draw-update', { lines: [], shapes: [] });\r\n        }}>Clear All</button>\r\n      </div>\r\n      <Stage\r\n        ref={stageRef}\r\n        width={window.innerWidth}\r\n        height={window.innerHeight}\r\n        onMouseDown={handleMouseDown}\r\n        onMouseMove={handleMouseMove}\r\n        onMouseUp={handleMouseUp}\r\n        onTouchStart={handleMouseDown}\r\n        onTouchMove={handleMouseMove}\r\n        onTouchEnd={handleMouseUp}\r\n      >\r\n        <Layer>\r\n          {lines.map((line, i) => (\r\n            <Line\r\n              key={i}\r\n              points={line.points}\r\n              stroke={line.tool === 'eraser' ? '#ffffff' : '#000000'}\r\n              strokeWidth={line.tool === 'eraser' ? 20 : 5}\r\n              tension={0.5}\r\n              lineCap=\"round\"\r\n              lineJoin=\"round\"\r\n              globalCompositeOperation={\r\n                line.tool === 'eraser' ? 'destination-out' : 'source-over'\r\n              }\r\n            />\r\n          ))}\r\n          {shapes.map((shape) => {\r\n            if (shape.type === 'line') {\r\n              return (\r\n                <Line\r\n                  key={shape.id}\r\n                  id={shape.id}\r\n                  points={[shape.x, shape.y, shape.x + shape.width, shape.y + shape.height]}\r\n                  stroke=\"#000000\"\r\n                  strokeWidth={5}\r\n                  draggable={tool === 'select'}\r\n                  onClick={() => setSelectedId(shape.id)}\r\n                  onTransformEnd={handleTransformEnd}\r\n                />\r\n              );\r\n            } else if (shape.type === 'rectangle') {\r\n              return (\r\n                <Rect\r\n                  key={shape.id}\r\n                  id={shape.id}\r\n                  x={shape.x}\r\n                  y={shape.y}\r\n                  width={shape.width}\r\n                  height={shape.height}\r\n                  rotation={shape.rotation}\r\n                  stroke=\"#000000\"\r\n                  strokeWidth={5}\r\n                  draggable={tool === 'select'}\r\n                  onClick={() => tool === 'select' && setSelectedId(shape.id)}\r\n                  onDragEnd={handleDragEnd}\r\n                  onTransformEnd={handleTransformEnd}\r\n                />\r\n              );\r\n            } else if (shape.type === 'circle') {\r\n              return (\r\n                <Circle\r\n                  key={shape.id}\r\n                  id={shape.id}\r\n                  x={shape.x + shape.width / 2}\r\n                  y={shape.y + shape.height / 2}\r\n                  radius={Math.abs(shape.width) / 2}\r\n                  stroke=\"#000000\"\r\n                  strokeWidth={5}\r\n                  draggable={tool === 'select'}\r\n                  onClick={() => tool === 'select' && setSelectedId(shape.id)}\r\n                  onDragEnd={handleDragEnd}\r\n                  onTransformEnd={handleTransformEnd}\r\n                  rotation={shape.rotation}\r\n                />\r\n              );\r\n            } else if (shape.type === 'image') {\r\n              const imageObj = new window.Image();\r\n              imageObj.src = shape.image;\r\n              return (\r\n                <Image\r\n                  key={shape.id}\r\n                  id={shape.id}\r\n                  image={imageObj}\r\n                  x={shape.x}\r\n                  y={shape.y}\r\n                  width={shape.width}\r\n                  height={shape.height}\r\n                  rotation={shape.rotation}\r\n                  draggable={tool === 'select'}\r\n                  onClick={() => tool === 'select' && setSelectedId(shape.id)}\r\n                  onDragEnd={handleDragEnd}\r\n                  onTransformEnd={handleTransformEnd}\r\n                />\r\n              );\r\n            }\r\n            return null;\r\n          })}\r\n          {selectedId && tool === 'select' && (\r\n            <Transformer\r\n              ref={transformerRef}\r\n              boundBoxFunc={(oldBox, newBox) => {\r\n                const isValid = newBox.width > 5 && newBox.height > 5;\r\n                return isValid ? newBox : oldBox;\r\n              }}\r\n              rotationSnaps={[0, 45, 90, 135, 180, 225, 270, 315]}\r\n              enabledAnchors={['top-left', 'top-right', 'bottom-left', 'bottom-right']}\r\n            />\r\n          )}\r\n        </Layer>\r\n      </Stage>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Whiteboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}